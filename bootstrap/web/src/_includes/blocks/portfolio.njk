{# Portfolio block: left column Recent Work, right column rich text. Optional column swap. #}
{% set leftFirst = true %}
{% if block.invert %}{% set leftFirst = false %}{% endif %}
{% set leftColOrder = 'order-md-1' %}
{% set rightColOrder = 'order-md-2' %}
{% if not leftFirst %}
  {% set leftColOrder = 'order-md-2' %}
  {% set rightColOrder = 'order-md-1' %}
{% endif %}
{% set title = block.title or 'Recent Work' %}

<section class="container my-5">
  <div class="row g-4">
    <div class="col-md-8 {{ leftColOrder }}">
      <div>
        <h4 class="fst-italic">{{ title }}</h4>
        {% if block.items and (block.items | length) > 0 %}
          <ul class="list-unstyled">
            {% for item in block.items %}
              <li>
                {% set borderClass = 'border-top' %}
                {% if loop.first %}{% set borderClass = '' %}{% endif %}

                {% set href = item.url %}
                {% set linkClass = 'portfolio__item py-3 link-body-emphasis text-decoration-none ' ~ borderClass %}
                {% set itemTitle = item.title %}
                {% set aria = 'Open work item: ' ~ (itemTitle or '') %}

                {% if href %}<a class="{{ linkClass }}" href="{{ href }}" aria-label="{{ aria }}">{% else %}<div class="{{ linkClass }}">{% endif %}
                  <div class="portfolio__thumb-wrap">
                    {% if item.imageUrl %}
                      {% set alt = item.imageAlt or item.title or '' %}
                      <img src="{{ item.imageUrl }}" alt="{{ alt }}" class="portfolio__thumb rounded-2 shadow-sm">
                    {% else %}
                      <svg aria-hidden="true" class="portfolio__thumb rounded-2 shadow-sm" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice">
                        <rect width="100%" height="100%" fill="#777"></rect>
                      </svg>
                    {% endif %}
                  </div>
                  <div class="portfolio__text">
                    {% if item.title %}<h6 class="mb-0 fw-semibold portfolio__title text-truncate">{{ item.title }}</h6>{% endif %}
                    {% if item.meta %}<small class="text-body-secondary d-block">{{ item.meta }}</small>{% endif %}
                  </div>
                {% if href %}</a>{% else %}</div>{% endif %}
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="alert alert-warning mb-0">No work items configured.</div>
        {% endif %}
      </div>
    </div>
    <div class="col-md-4 {{ rightColOrder }}">
      <div class="p-4 mb-3 bg-body-tertiary rounded">
        {% if block.right and block.right[0] and block.right[0]._type %}
          {{ block.right | pt | safe }}
        {% else %}
          {{ block.right | safe }}
        {% endif %}
      </div>
    </div>
  </div>
</section>
